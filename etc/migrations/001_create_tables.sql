CREATE TABLE IF NOT EXISTS "organization" (
  "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  "date_created" timestamptz NOT NULL,
  "date_updated" timestamptz NOT NULL,
  "public_id" character varying NOT NULL,
  "type" character varying NOT NULL DEFAULT 'organization',
  "acronym" character varying NULL,
  "name_dut" character varying NULL,
  "name_eng" character varying NULL,
  "identifier" jsonb NULL,
  PRIMARY KEY ("id")
);

CREATE INDEX IF NOT EXISTS "organization_acronym" ON "organization" ("acronym");
CREATE UNIQUE INDEX IF NOT EXISTS "organization_public_id_key" ON "organization" ("public_id");
CREATE INDEX IF NOT EXISTS "organization_type" ON "organization" ("type");

CREATE TABLE IF NOT EXISTS "organization_parent" (
  "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  "date_created" timestamptz NOT NULL,
  "date_updated" timestamptz NOT NULL,
  "parent_organization_id" bigint NOT NULL,
  "organization_id" bigint NOT NULL,
  "from" timestamptz NOT NULL,
  "until" timestamptz NULL,
  PRIMARY KEY ("id")
);
CREATE INDEX IF NOT EXISTS "organizationparent_organization_id" ON "organization_parent" ("organization_id");
CREATE INDEX IF NOT EXISTS "organizationparent_parent_organization_id" ON "organization_parent" ("parent_organization_id");
CREATE UNIQUE INDEX IF NOT EXISTS "organizationparent_parent_organization_id_organization_id_from" ON "organization_parent" ("parent_organization_id", "organization_id", "from");

CREATE TABLE IF NOT EXISTS "organization_person" (
  "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  "date_created" timestamptz NOT NULL,
  "date_updated" timestamptz NOT NULL,
  "organization_id" bigint NOT NULL,
  "person_id" bigint NOT NULL,
  "from" timestamptz NOT NULL,
  "until" timestamptz NULL,
  PRIMARY KEY ("id")
);
CREATE INDEX IF NOT EXISTS "organizationperson_organization_id" ON "organization_person" ("organization_id");
CREATE INDEX IF NOT EXISTS "organizationperson_person_id" ON "organization_person" ("person_id");
CREATE UNIQUE INDEX IF NOT EXISTS "organizationperson_person_id_organization_id_from" ON "organization_person" ("person_id", "organization_id", "from");

CREATE TABLE IF NOT EXISTS "person" (
  "id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  "date_created" timestamptz NOT NULL,
  "date_updated" timestamptz NOT NULL,
  "public_id" character varying NOT NULL,
  "active" boolean NOT NULL DEFAULT false,
  "birth_date" character varying NULL,
  "email" character varying NULL,
  "identifier" jsonb NULL,
  "given_name" character varying NULL,
  "name" character varying NULL,
  "family_name" character varying NULL,
  "job_category" jsonb NULL,
  "preferred_given_name" character varying NULL,
  "preferred_family_name" character varying NULL,
  "honorific_prefix" character varying NULL,
  "role" jsonb NULL,
  "settings" jsonb NULL,
  "object_class" jsonb NULL,
  "expiration_date" character varying NULL,
  "token" jsonb NULL,
  PRIMARY KEY ("id")
);
CREATE INDEX IF NOT EXISTS "person_active" ON "person" ("active");
CREATE INDEX IF NOT EXISTS "person_email" ON "person" ("email");
CREATE INDEX IF NOT EXISTS "person_family_name" ON "person" ("family_name");
CREATE INDEX IF NOT EXISTS "person_given_name" ON "person" ("given_name");
CREATE INDEX IF NOT EXISTS "person_name" ON "person" ("name");
CREATE UNIQUE INDEX IF NOT EXISTS "person_public_id_key" ON "person" ("public_id");

---- create above / drop below ----

DROP TABLE IF EXISTS "organization_parent" CASCADE;
DROP TABLE IF EXISTS "organization_person" CASCADE;
DROP TABLE IF EXISTS "person" CASCADE;
DROP TABLE IF EXISTS "organization" CASCADE;
